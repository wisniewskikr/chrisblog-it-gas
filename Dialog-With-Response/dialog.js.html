<script
  src="https://code.jquery.com/jquery-3.5.1.min.js"
  integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
  crossorigin="anonymous"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa"
      crossorigin="anonymous"></script>

<script src="https://cdn.jsdelivr.net/npm/jQuery-QueryBuilder/dist/js/query-builder.standalone.min.js"></script>

<script>

  $(document).ready(function() {
    onInitExportDialog();
  })

  function onInitExportDialog() {

    google.script.run
      .withSuccessHandler(function(response) {

        var responseObj = JSON.parse(response);
        var text = responseObj.text;
        $('#message').text(text);
        $('#preloader').hide();        

      })
      .withFailureHandler(function(error) {
        handleError(error);
      })
      .callLibraryFunction("onInitExportDialog_", null);

  }

  function handleError(error) {

    $('#message').hide();
    $('#preloader').hide();
    $('#status-message').addClass('error')
    $('#status-message').text(error)
    $('#status-message').show()
    $('#status').show();

  }

</script>
